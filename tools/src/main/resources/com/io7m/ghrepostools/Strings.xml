<?xml version="1.0" encoding="UTF-8" standalone="no"?>

<!DOCTYPE properties SYSTEM "http://java.sun.com/dtd/properties.dtd">

<properties>

  <!-- {0}: Group name with dots (com.io7m.example) -->
  <!-- {1}: Group name with slashes (com/io7m/example) -->
  <!-- {2}: Artifact name with dots (com.io7m.example) -->
  <!-- {3}: Short name (example) -->
  <entry key="readmeTemplate"><![CDATA[{3}
===

[![Maven Central](https://img.shields.io/maven-central/v/{0}/{2}.svg?style=flat-square)](http://search.maven.org/#search%7Cga%7C1%7Cg%3A%22{2}%22)
[![Maven Central (snapshot)](https://img.shields.io/nexus/s/{0}/{2}?server=https%3A%2F%2Fs01.oss.sonatype.org&style=flat-square)](https://s01.oss.sonatype.org/content/repositories/snapshots/{1}/)
[![Codecov](https://img.shields.io/codecov/c/github/io7m-com/{3}.svg?style=flat-square)](https://codecov.io/gh/io7m-com/{3})

![{2}](./src/site/resources/{3}.jpg?raw=true)

| JVM | Platform | Status |
|-----|----------|--------|]]></entry>

  <!--                                                 -->
  <!-- The main workflow executed on all platforms.    -->
  <!--                                                 -->
  <!-- {0}: Workflow name                              -->
  <!-- {1}: Runner image name (ubuntu-latest, etc)     -->
  <!-- {2}: Java version (21, etc)                     -->
  <!-- {3}: Java distribution (temurin, etc)           -->
  <!-- {4}: Project short name (jeucreader, etc)       -->
  <entry key="workflowAuthenticatedCoverageTemplate"><![CDATA[name: {0}

on:
  push:
    branches: [ develop, feature/*, release/* ]

jobs:
  build:
    runs-on: {1}
    steps:
      - uses: actions/checkout@v4
        with:
          submodules: true

      - name: JDK
        uses: actions/setup-java@v4
        with:
          java-version: {2}
          distribution: {3}

      - name: Collect project version
        id: project_version
        run: java .github/workflows/Tools.java ShowProjectVersion pom.xml >> "$GITHUB_OUTPUT"

      - name: Collect project snapshot
        id: project_is_snapshot
        run: java .github/workflows/Tools.java ShowProjectIsSnapshot pom.xml >> "$GITHUB_OUTPUT"

      - name: Build
        run: mvn --batch-mode --strict-checksums --errors clean verify site

      - name: Upload test logs
        uses: actions/upload-artifact@v4
        if: always()
        with:
          name: test-logs
          path: ./com.io7m.{4}.tests/target/surefire-reports

      - name: Coverage
        uses: codecov/codecov-action@v4.3.1
        with:
          token: $'{{' secrets.CODECOV_TOKEN '}}'
          file: com.io7m.{4}.tests/target/site/jacoco-aggregate/jacoco.xml

      - name: Deploy snapshot
        if: '${{' steps.project_is_snapshot.outputs.IO7M_PROJECT_VERSION_IS_SNAPSHOT == ''true'' '}}'
        env:
          MAVEN_CENTRAL_USERNAME: $'{{' secrets.MAVEN_CENTRAL_USERNAME '}}'
          MAVEN_CENTRAL_PASSWORD: $'{{' secrets.MAVEN_CENTRAL_PASSWORD '}}'
        run: .github/workflows/deploy-snapshot.sh

]]></entry>

  <!--                                                 -->
  <!-- The main workflow executed to deploy releases.  -->
  <!--                                                 -->
  <!-- {0}: Workflow name                              -->
  <!-- {1}: Runner image name (ubuntu-latest, etc)     -->
  <!-- {2}: Java version (21, etc)                     -->
  <!-- {3}: Java distribution (temurin, etc)           -->
  <!-- {4}: Project short name (jeucreader, etc)       -->
  <entry key="workflowDeployTemplate"><![CDATA[name: {0}

on:
  push:
    tags: [ com.io7m.{4}-* ]

jobs:
  build:
    runs-on: {1}
    steps:
      - uses: actions/checkout@v4
        with:
          submodules: true

      - name: JDK
        uses: actions/setup-java@v4
        with:
          java-version: {2}
          distribution: {3}

      - name: Import signing key
        env:
          PGP_SIGNING_KEY: $'{{' secrets.PGP_SIGNING_KEY '}}'
        run: echo "$'{'PGP_SIGNING_KEY'}'" | gpg --import

      - name: Deploy release
        env:
          MAVEN_CENTRAL_USERNAME: $'{{' secrets.MAVEN_CENTRAL_USERNAME '}}'
          MAVEN_CENTRAL_PASSWORD: $'{{' secrets.MAVEN_CENTRAL_PASSWORD '}}'
        run: .github/workflows/deploy-release.sh

]]></entry>

  <entry key="dependabotTemplate"><![CDATA[
version: 2

updates:
  - package-ecosystem: "github-actions"
    directory: "/"
    schedule:
      interval: "daily"

  - package-ecosystem: "maven"
    directory: "/"
    schedule:
      interval: "daily"

    target-branch: "develop"
    ignore:
      - dependency-name: "*"
        update-types: [ "version-update:semver-major" ]
]]></entry>

</properties>